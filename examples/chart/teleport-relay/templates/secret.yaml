{{- if .Values.joinTokenSecret.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "teleport-relay.joinTokenSecretName" . | quote }}
  {{- with .Values.extraLabels.secret }}
  labels:
    {{- toYaml . | nindent 4 }}
  {{- end }}
  {{- with .Values.annotations.secret }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
type: Opaque
stringData:
  auth-token: {{ required "joinParams.tokenName must be specified if joinTokenSecret.create is enabled" .Values.joinParams.tokenName | quote }}
{{- end }}
