apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "teleport-relay.fullname" . }}
  labels:
    {{- include "teleport-relay.labels" . | nindent 4 }}
    {{- with .Values.extraLabels.config }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
  {{- with .Values.annotations.config }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
data:
  teleport.yaml: |
    {{- mustMergeOverwrite (include "teleport-relay.config" . | fromYaml) .Values.teleportConfig | toYaml | nindent 4 -}}
