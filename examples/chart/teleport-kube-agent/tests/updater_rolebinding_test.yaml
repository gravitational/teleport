#suite: Updater RoleBinding (rendered by parent chart)
#
#tests:
#  #
#  # Basic wiring tests (dependency renders when enabled)
#  #
#  - it: does not render updater RoleBinding when updater.enabled is false (default)
#    asserts:
#      - not: true
#        containsDocument:
#          kind: RoleBinding
#          apiVersion: rbac.authorization.k8s.io/v1
#          name: RELEASE-NAME-updater
#          namespace: NAMESPACE
#
#  - it: renders updater RoleBinding when updater.enabled is true
#    values:
#      - ../.lint/updater.yaml
#    asserts:
#      - containsDocument:
#          kind: RoleBinding
#          apiVersion: rbac.authorization.k8s.io/v1
#          name: RELEASE-NAME-updater
#          namespace: NAMESPACE
#
#  - it: does not render updater RoleBinding when updater.enabled is true but RBAC creation is disabled
#    values:
#      - ../.lint/updater.yaml
#    set:
#      updater:
#        rbac:
#          create: false
#    asserts:
#      - not: true
#        containsDocument:
#          kind: RoleBinding
#          apiVersion: rbac.authorization.k8s.io/v1
#          name: RELEASE-NAME-updater
#          namespace: NAMESPACE
#
#  #
#  # Content tests (assert fields on the rendered RoleBinding)
#  #
#  - it: sets roleRef correctly on updater RoleBinding
#    values:
#      - ../.lint/updater.yaml
#    asserts:
#      - documentSelector:
#          path: kind
#          value: RoleBinding
#        equal:
#          path: metadata.name
#          value: RELEASE-NAME-updater
#      - documentSelector:
#          path: kind
#          value: RoleBinding
#        equal:
#          path: spec.roleRef
#          value:
#            apiGroup: rbac.authorization.k8s.io
#            kind: Role
#            name: RELEASE-NAME-updater
#
#  - it: sets subjects correctly on updater RoleBinding
#    values:
#      - ../.lint/updater.yaml
#    asserts:
#      - documentSelector:
#          path: kind
#          value: RoleBinding
#        equal:
#          path: spec.subjects
#          value:
#            - kind: ServiceAccount
#              name: RELEASE-NAME-updater
#              namespace: NAMESPACE