---
title: Synchronization with Okta and SCIM
description: Managing Okta resources in Teleport
---

The Okta integration imports and synchronizes resources from an Okta
organisation. This guide details how those Okta resources are represented inside
a Teleport cluster.

## Synchronization & SCIM

Teleport uses two complimentary methods for synchronizing Teleport resources with
an upstream Okta Organization:
 - the Okta integration [synchronization process](./architecture.mdx)
 - provisioning via SCIM 

On the whole, it doesn't matter to the wider Teleport system which method was
used to import a user as both processes create identical resources inside
Teleport. 

## Users

### Importing users

During synchronization, the Okta integration will create Teleport user accounts 
for all eligible Okta users, and clean up the Teleport accounts of any Okta users
that have been deactivated. The list of "eligible Okta users" depends on the
integration configuration. 

If the Okta integration is configured to use a specific Okta application, then
the Okta integration will consider any Okta user assigned to that Okta 
application - either directly, or via group membership - as an "eligible user". 

If no Okta application is to use is supplied, all enabled Okta organization
users are considered "eligible".

<Admonition type="note">
All hosted Okta integrations are configured to restrict their pool of users to
a specific Okta application.

The integration [enrolment process](./hosted-guide.mdx) creates an Okta SAML
Application to use as the identity provider for a new
[SAML Authentication Connector](../../access-controls/sso/okta.mdx). The enrolment
process automatically configures the Okta integration to use this same
application, giving the Okta administrator a single point of integration to
administer and secure.
</Admonition>

### Okta Profile to Teleport User

The Teleport users created by the synchronization process or SCIM provisioning
all inherit their username from the upstream Okta organization, and are given a
default role of `okta-requester`. 

This Role allows the user to log into Teleport, but grants no default access to
Teleport resources. The Teleport admin can use Access Requests and Access Lists
to grant access to Teleport resources as they see fit, once the user is
imported.

### Traits

All non-empty values in the Okta User/AppUser profile are converted to Teleport
user traits. For example, an imported Okta user might look like this:

```yaml
kind: user
metadata:
  name: hiro@enzos-pizza.com
  labels:
    okta/org: https://enzos-pizza.okta.com
    teleport.dev/origin: okta
roles:
  - okta-requester
spec:
  traits:
    okta/email:
      - hiro@enzos-pizza.com
    okta/firstName:
      - Hiro
    okta/lastName:
      - Protagonist
    okta/login:
      - hiro@enzos-pizza.com
```

Teleport administrators can then use these traits as conditions in Access Lists
in order to grant (or deny) the Okta-derived Teleport users access to Teleport
resources.

### Deleting Users

In the case where
 1. the synchronization process detects that an Okta user has been deactivated
    or suspended, or 
 1. the Okta organization explicitly disables the account via SCIM, 
 
The Okta integration will immediately delete the corresponding Teleport
account and create a temporary Teleport user lock. The user lock will 
 - terminate any active Teleport sessions, and
 - prevent the disabled user from accessing any Teleport resources with
   credentials issued before their Teleport account was deleted.

The user lock will expire after the maximum possible credential lifetime, plus
a small safety margin.

<Admonition type="warning">
Suspended Okta users will not be locked by Teleport.

When a user is suspended in Okta, Okta does not communicate the suspension to
Teleport and so Teleport will not automatically lock and remove that user.

Be sure to either deactivate the user, or unassign them from the Okta SAML
Application in order to make sure their status is updated in Teleport.
</Admonition>
