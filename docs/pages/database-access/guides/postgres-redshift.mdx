---
title: Database Access with Redshift on AWS
description: How to configure Teleport Database Access with AWS Redshift PostgreSQL.
videoBanner: UFhT52d5bYg
---

# AWS Redshift PostgreSQL

## Prerequisites

- Teleport version `(=teleport.version=)`.
- AWS account with a Redshift cluster and permissions to create and attach IAM
  policies.

## Step 1/6. Install Teleport

(!docs/pages/includes/database-access/start-auth-proxy.mdx!)

## Step 2/6. Create Teleport user

(!docs/pages/includes/database-access/create-user.mdx!)

## Step 3/6. Create database agent configuration

(!docs/pages/includes/database-access/token.mdx!)

Create the database agent configuration using the database configurator:

```code
$ teleport db configure create -o file --proxy=teleport.example.com:3080 --token=/tmp/token --redshift-discovery=us-west-1
```

The command will generate a database agent configuration with Redshift
databases auto-discovery enabled on the `us-west-1` region and place it at the
`/etc/teleport.yaml` location.

## Step 4/6. Configure IAM

### Create IAM policy for Teleport

Teleport needs AWS IAM permissions to be able to:

- Discover and register Redshift databases.
- Manage IAM user or IAM role policies.

(!docs/pages/includes/database-access/aws-bootstrap.mdx!)

## Step 5/6. Start the database agent

```code
$ teleport start --config=/etc/teleport.yaml
```

The agent will discover all Redshift databases according to the configuration
and register them in the cluster. The agent will also attempt to configure IAM
access policies for the discovered databases. Keep in mind that AWS IAM changes
may not propagate immediately and can take a few minutes to come into effect.

<Admonition type="note" title="AWS credentials">
  Teleport database agent uses the default credential provider chain to find AWS
  credentials. See [Specifying Credentials](https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html#specifying-credentials)
  for more information.
</Admonition>

## Step 6/6. Connect

Once the database agent has started and joined the cluster, log in to see the
registered databases. Replace `--proxy` with the address of your Teleport Proxy Service,
e.g., `mytenant.teleport.sh` for Teleport Cloud users.

```code
$ tsh login --proxy=teleport.example.com --user=alice
$ tsh db ls
# Name        Description                    Labels
# ----------- ------------------------------ --------
# my-redshift Redshift cluster in us-east-1  ...
```

Log into a particular database using the `tsh db login` command:

```code
$ tsh db login my-redshift
```

<Admonition type="tip" title="Tip">
  You can be logged into multiple databases simultaneously.
</Admonition>

You can optionally specify the database name and the user to use by default
when connecting to the database instance:

```code
$ tsh db login --db-user=awsuser --db-name=dev my-redshift
```

<Admonition type="note" title="Database users must exist">
  Teleport does not currently use the auto-create option when generating
  tokens for Redshift databases. Users must exist in the database.
</Admonition>

Now connect to the database:

```code
$ tsh db connect my-redshift
```

<Admonition type="note" title="Note">
  The `psql` command-line client should be available in `PATH` in order to be
  able to connect.
</Admonition>

To log out of the database and remove credentials:

```code
$ tsh db logout my-redshift
```

## Next steps

- Learn more about [using IAM authentication to generate database user
  credentials](https://docs.aws.amazon.com/redshift/latest/mgmt/generating-user-credentials.html) for AWS Redshift.
- Learn how to [restrict access](../rbac.mdx) to certain users and databases.
- View the [High Availability (HA)](../guides/ha.mdx) guide.
- Take a look at the YAML configuration [reference](../reference/configuration.mdx).
