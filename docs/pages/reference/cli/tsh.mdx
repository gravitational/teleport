---
title: tsh Reference
description: Provides a comprehensive list of commands, arguments, and flags for tsh.
---

This guide provides a comprehensive list of commands, arguments, and flags for
tsh: Teleport Command Line Client.

```code
$ tsh [<flags>] <command> [<args> ...]
```

Global flags:

|Flag|Default|Description|
|---|---|---|
|`-l`, `--login`|none|Remote host login.|
|`--proxy`|none|Teleport proxy address.|
|`--user`|none|Teleport user, defaults to current local user.|
|`--ttl`|none|Minutes to live for a session.|
|`-i`, `--identity`|none|Identity file.|
|`--cert-format`|none|SSH certificate format.|
|`--[no-]insecure`|`false`|Do not verify server's certificate and host name. Use only in test environments.|
|`--auth`|none|Specify the name of authentication connector to use.|
|`--[no-]skip-version-check`|`false`|Skip version checking between server and client.|
|`-d`, `--[no-]debug`|`false`|Verbose logging to stdout.|
|`--[no-]os-log`|`false`|Verbose logging to the unified logging system. This flag implies --debug. Also available through the TELEPORT_OS_LOG env var. More details see https://goteleport.com/docs/connect-your-client/tsh/#debug-logs.|
|`-k`, `--add-keys-to-agent`|`auto`|Controls how keys are handled. Valid values are [auto no yes only].|
|`--[no-]enable-escape-sequences`|`true`|Enable support for SSH escape sequences. Type '~?' during an SSH session to list supported sequences. Default is enabled.|
|`--bind-addr`|none|Override host:port used when opening a browser for cluster logins.|
|`--callback`|none|Override the base URL (host:port) of the link shown when opening a browser for cluster logins. Must be used with --bind-addr.|
|`--mfa-mode`|`auto`|Preferred mode for MFA and Passwordless assertions (auto, cross-platform, platform, otp, sso).|
|`--[no-]headless`|`false`|Use headless login. Shorthand for --auth=headless.|
|`--mlock`|`auto`|Determines whether process memory will be locked and whether failure to do so will be accepted (off, auto, best_effort, strict).|
|`--piv-slot`|none|Specify a PIV slot key to use for Hardware Key support instead of the default. Ex: "9d".|
|`-J`, `--jumphost`|none|SSH jumphost.|

Global environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_LOGIN`|none|Remote host login.|
|`TELEPORT_PROXY`|none|Teleport proxy address.|
|`TELEPORT_USER`|none|Teleport user, defaults to current local user.|
|`TELEPORT_IDENTITY_FILE`|none|Identity file.|
|`TELEPORT_AUTH`|none|Specify the name of authentication connector to use.|
|`TELEPORT_ADD_KEYS_TO_AGENT`|`auto`|Controls how keys are handled. Valid values are [auto no yes only].|
|`TELEPORT_LOGIN_BIND_ADDR`|none|Override host:port used when opening a browser for cluster logins.|
|`TELEPORT_MFA_MODE`|`auto`|Preferred mode for MFA and Passwordless assertions (auto, cross-platform, platform, otp, sso).|
|`TELEPORT_HEADLESS`|`false`|Use headless login. Shorthand for --auth=headless.|
|`TELEPORT_MLOCK_MODE`|`auto`|Determines whether process memory will be locked and whether failure to do so will be accepted (off, auto, best_effort, strict).|
|`TELEPORT_PIV_SLOT`|none|Specify a PIV slot key to use for Hardware Key support instead of the default. Ex: "9d".|

## tsh apps config

Print app connection information.

Usage:

```code
$ tsh apps config [<flags>] [<app>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|none|Optional print format, one of: "uri" to print app address, "ca" to print CA cert path, "cert" to print cert path, "key" print key path, "curl" to print example curl command, "json" or "yaml" to print everything as JSON or YAML.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|app|none (optional)|App to print information for. Required when logged into multiple apps.|

## tsh apps login

Retrieve short-lived certificate for an app.

Usage:

```code
$ tsh apps login [<flags>] <app>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--aws-role`|none|(For AWS CLI access only) Amazon IAM role ARN or role name.|
|`--azure-identity`|none|(For Azure CLI access only) Azure managed identity name.|
|`--gcp-service-account`|none|(For GCP CLI access only) GCP service account name.|
|`--target-port`|none|Port to which connections made using this cert should be routed to. Valid only for multi-port TCP apps.|
|`-q`, `--[no-]quiet`|`false`|Quiet mode.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|app|none (required)|App name to retrieve credentials for. Can be obtained from `tsh apps ls` output.|

## tsh apps logout

Remove app certificate.

Usage:

```code
$ tsh apps logout [<app>]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|app|none (optional)|App to remove credentials for.|

## tsh apps ls

List available applications.

Usage:

```code
$ tsh apps ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-v`, `--[no-]verbose`|`false`|Show extra application fields.|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-R`, `--[no-]all`|`false`|List apps from all clusters and proxies.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh aws

Access AWS API.

Usage:

```code
$ tsh aws [<flags>] [<command>...]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional Name of the AWS application to use if logged into multiple.|
|`--exec`|none|Execute different commands (e.g. terraform) under Teleport credentials.|
|`--aws-role`|none|(For AWS CLI access only) Amazon IAM role ARN or role name.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (optional)|AWS command and subcommands arguments that are going to be forwarded to AWS CLI.|

## tsh az

Access Azure API.

Usage:

```code
$ tsh az [<flags>] [<command>...]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional name of the Azure application to use if logged into multiple.|
|`--azure-identity`|none|(For Azure CLI access only) Azure managed identity name.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (optional)|`az` command and subcommands arguments that are going to be forwarded to Azure CLI.|

## tsh clusters

List available Teleport clusters.

Usage:

```code
$ tsh clusters [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-q`, `--[no-]quiet`|`false`|Quiet mode.|
|`-v`, `--[no-]verbose`|`false`|Verbose table output, shows full label output.|

## tsh config

Print OpenSSH configuration details.

Usage:

```code
$ tsh config [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-p`, `--port`|none|SSH port on a remote host.|

## tsh db config

Print database connection information. Useful when configuring GUI clients.

Usage:

```code
$ tsh db config [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-f`, `--format`|none|Print format: "text" to print in table format (default), "cmd" to print connect command, "json" or "yaml" to print in JSON or YAML.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|Print information for the specified database.|

## tsh db connect

Connect to a database.

Usage:

```code
$ tsh db connect [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-u`, `--db-user`|none|Database user to log in as.|
|`-n`, `--db-name`|none|Database name to log in to.|
|`-r`, `--db-roles`|none|List of comma separate database roles to use for auto-provisioned user.|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--request-reason`|none|Reason for requesting access.|
|`--[no-]disable-access-request`|`false`|Disable automatic resource access requests.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|Database service name to connect to.|

## tsh db env

Print environment variables for the configured database.

Usage:

```code
$ tsh db env [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|Print environment for the specified database.|

## tsh db exec

Execute database commands on target database services.

Usage:

```code
$ tsh db exec [<flags>] <command>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-u`, `--db-user`|none|Database user to log in as.|
|`-n`, `--db-name`|none|Database name to log in to.|
|`-r`, `--db-roles`|none|List of comma separate database roles to use for auto-provisioned user.|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--parallel`|`1`|Run commands on target databases in parallel. Defaults to 1, and maximum allowed is 10.|
|`--output-dir`|none|Directory to store command output per target database service. A summary is saved as "summary.json".|
|`--dbs`|none|List of comma separated target database services. Mutually exclusive with --search or --labels.|
|`--[no-]confirm`|`true`|Confirm selected database services before executing command.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (required)|Execute this command on target database services.|

## tsh db login

Retrieve credentials for a database.

Usage:

```code
$ tsh db login [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-u`, `--db-user`|none|Database user to configure as default.|
|`-n`, `--db-name`|none|Database name to configure as default.|
|`-r`, `--db-roles`|none|List of comma separate database roles to use for auto-provisioned user.|
|`--request-reason`|none|Reason for requesting access.|
|`--[no-]disable-access-request`|`false`|Disable automatic resource access requests.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|Database to retrieve credentials for. Can be obtained from 'tsh db ls' output.|

## tsh db logout

Remove database credentials.

Usage:

```code
$ tsh db logout [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|Database to remove credentials for.|

## tsh db ls

List all available databases.

Usage:

```code
$ tsh db ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-v`, `--[no-]verbose`|`false`|Show extra database fields.|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-R`, `--[no-]all`|`false`|List databases from all clusters and proxies.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh device enroll

Enroll this device as a trusted device. Requires Teleport Enterprise.

Usage:

```code
$ tsh device enroll [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--[no-]current-device`|`false`|Attempts to register and enroll the current device. Requires device admin privileges.|
|`--token`|none|Device enrollment token.|

## tsh env

Print commands to set Teleport session environment variables.

Usage:

```code
$ tsh env [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--[no-]unset`|`false`|Print commands to clear Teleport session environment variables.|

## tsh gcloud

Access GCP API with the gcloud command.

Usage:

```code
$ tsh gcloud [<flags>] [<command>...]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional name of the GCP application to use if logged into multiple.|
|`--gcp-service-account`|none|(For GCP CLI access only) GCP service account name.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (optional)|`gcloud` command and subcommands arguments.|

## tsh git clone

Clone a Git repository.

Usage:

```code
$ tsh git clone <repository> [<directory>]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|repository|none (required)|Git URL of the repository to clone.|
|directory|none (optional)|The name of a new directory to clone into.|

## tsh git config

Check Teleport config on the working Git directory. Or provide an action
('update' or 'reset') to configure the Git repo.

Usage:

```code
$ tsh git config [<action>]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|action|none (optional)|Optional action to perform. 'update' to configure the Git repo to proxy Git commands through Teleport. 'reset' to clear Teleport configuration from the Git repo.|

## tsh git login

Opens a browser and retrieves your login from GitHub.

Usage:

```code
$ tsh git login --github-org=GITHUB-ORG [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--github-org`|none|GitHub organization.|
|`--[no-]force`|`false`|Force a login.|

## tsh git ls

List Git servers.

Usage:

```code
$ tsh git ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh gsutil

Access Google Cloud Storage with the gsutil command.

Usage:

```code
$ tsh gsutil [<flags>] [<command>...]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional name of the GCP application to use if logged into multiple.|
|`--gcp-service-account`|none|(For GCP CLI access only) GCP service account name.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (optional)|`gsutil` command and subcommands arguments.|

## tsh headless approve

Approve a headless authentication request.

Usage:

```code
$ tsh headless approve [<flags>] [<request id>]
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_HEADLESS_SKIP_CONFIRM`|`false`|Skip confirmation and prompt for MFA immediately.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`--[no-]skip-confirm`|`false`|Skip confirmation and prompt for MFA immediately.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|request id|none (optional)|Headless authentication request ID.|

## tsh help

Show help.

Usage:

```code
$ tsh help [<command>...]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|command|none (optional)|Show help on command.|

## tsh join

Join the active SSH or Kubernetes session.

Usage:

```code
$ tsh join [<flags>] <session-id>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`-m`, `--mode`|`observer`|Mode of joining the session, valid modes are observer, moderator and peer.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|session-id|none (required)|ID of the session to join.|

## tsh kube exec

Execute a command in a Kubernetes pod.

Usage:

```code
$ tsh kube exec [<flags>] <target> <command>...
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--container`|none|Container name. If omitted, use the kubectl.kubernetes.io/default-container annotation for selecting the container to be attached or the first container in the pod will be chosen.|
|`-n`, `--namespace`|none|Configure the default Kubernetes namespace.|
|`-f`, `--filename`|none|To use to exec into the resource.|
|`-q`, `--[no-]quiet`|`false`|Only print output from the remote session.|
|`-s`, `--[no-]stdin`|`false`|Pass stdin to the container.|
|`-t`, `--[no-]tty`|`false`|Stdin is a TTY.|
|`--reason`|none|The purpose of the session.|
|`--invite`|none|A comma separated list of people to mark as invited for the session.|
|`--[no-]participant-req`|`false`|Displays a verbose list of required participants in a moderated session.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|target|none (required)|Pod or deployment name.|
|command|none (required)|Command to execute in the container.|

## tsh kube join

Join an active Kubernetes session.

Usage:

```code
$ tsh kube join [<flags>] <session>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-m`, `--mode`|`observer`|Mode of joining the session, valid modes are observer, moderator and peer.|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|session|none (required)|The ID of the target session.|

## tsh kube login

Login to a Kubernetes cluster.

Usage:

```code
$ tsh kube login [<flags>] [<kube-cluster>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--as`|none|Configure custom Kubernetes user impersonation.|
|`--as-groups`|none|Configure custom Kubernetes group impersonation.|
|`-n`, `--namespace`|none|Configure the default Kubernetes namespace.|
|`--[no-]all`|`false`|Generate a kubeconfig with every cluster the user has access to. Mutually exclusive with --labels or --query.|
|`--set-context-name`|`{{.ClusterName}}-{{.KubeName}}`|Define a custom context name. To use it with --all include "\{\{.KubeName\}\}".|
|`--request-reason`|none|Reason for requesting access.|
|`--[no-]disable-access-request`|`false`|Disable automatic resource access requests.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|kube-cluster|none (optional)|Name of the Kubernetes cluster to login to. Check 'tsh kube ls' for a list of available clusters.|

## tsh kube ls

Get a list of Kubernetes clusters.

Usage:

```code
$ tsh kube ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-R`, `--[no-]all`|`false`|List Kubernetes clusters from all clusters and proxies.|
|`-v`, `--[no-]verbose`|`false`|Show an untruncated list of labels.|
|`-q`, `--[no-]quiet`|`false`|Quiet mode.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh kube sessions

Get a list of active Kubernetes sessions. (DEPRECATED: use tsh sessions ls
--kind=kube instead.)

Usage:

```code
$ tsh kube sessions [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|

## tsh kubectl

Runs a kubectl command on a Kubernetes cluster.

Usage:

```code
$ tsh kubectl [args...]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|args|none (optional)|Arbitrary arguments|

## tsh latency ssh

Measure latency to a particular SSH host.

Usage:

```code
$ tsh latency ssh [<flags>] <[user@]host>
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_NO_RESUME`|`false`|Disable SSH connection resumption.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--[no-]no-resume`|`false`|Disable SSH connection resumption.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|[user@]host|none (required)|Remote hostname and the login to use.|

## tsh login

Log in to a cluster and retrieve the session certificate.

Usage:

```code
$ tsh login [<flags>] [<cluster>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-o`, `--out`|none|Identity output.|
|`-f`, `--format`|`file`|Identity format: file, openssh (for OpenSSH compatibility) or kubernetes (for kubeconfig).|
|`--[no-]overwrite`|`false`|Whether to overwrite the existing identity file.|
|`--request-roles`|none|Request one or more extra roles.|
|`--request-reason`|none|Reason for requesting additional roles.|
|`--request-reviewers`|none|Suggested reviewers for role request.|
|`--[no-]request-nowait`|`false`|Finish without waiting for request resolution.|
|`--request-id`|none|Login with the roles requested in the given request.|
|`--browser`|none|Set to 'none' to suppress browser opening on login.|
|`--kube-cluster`|none|Name of the Kubernetes cluster to login to.|
|`-v`, `--[no-]verbose`|`false`|Show extra status information.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|cluster|none (optional)|Specify the Teleport cluster to connect.|

## tsh logout

Delete a cluster certificate.

Usage:

```code
$ tsh logout
```

## tsh ls

List remote SSH nodes.

Usage:

```code
$ tsh ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`-v`, `--[no-]verbose`|`false`|One-line output (for text format), including node UUIDs.|
|`-f`, `--format`|`text`|Format output (text, json, yaml, names).|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-R`, `--[no-]all`|`false`|List nodes from all clusters and proxies.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh mcp config

Print client configuration details.

Usage:

```code
$ tsh mcp config [<flags>] [<name>]
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_MCP_CLIENT_CONFIG`|none|If specified, update the specified client config. "claude" for default Claude Desktop config, or specify a JSON file path. Can also be set with environment variable TELEPORT_MCP_CLIENT_CONFIG.|
|`TELEPORT_MCP_CONFIG_JSON_FORMAT`|`auto`|Format the JSON file (pretty, compact, auto, none). auto saves in compact if the file is already compact, otherwise pretty. Can also be set with environment variable TELEPORT_MCP_CONFIG_JSON_FORMAT. Default is auto.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-R`, `--[no-]all`|`false`|Select all MCP servers. Mutually exclusive with --labels or --query.|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--client-config`|none|If specified, update the specified client config. "claude" for default Claude Desktop config, or specify a JSON file path. Can also be set with environment variable TELEPORT_MCP_CLIENT_CONFIG.|
|`--json-format`|`auto`|Format the JSON file (pretty, compact, auto, none). auto saves in compact if the file is already compact, otherwise pretty. Can also be set with environment variable TELEPORT_MCP_CONFIG_JSON_FORMAT. Default is auto.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|name|none (optional)|Name of the MCP server.|

## tsh mcp db config

Print client configuration details.

Usage:

```code
$ tsh mcp db config [<flags>] [<name>]
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_MCP_CLIENT_CONFIG`|none|If specified, update the specified client config. "claude" for default Claude Desktop config, or specify a JSON file path. Can also be set with environment variable TELEPORT_MCP_CLIENT_CONFIG.|
|`TELEPORT_MCP_CONFIG_JSON_FORMAT`|`auto`|Format the JSON file (pretty, compact, auto, none). auto saves in compact if the file is already compact, otherwise pretty. Can also be set with environment variable TELEPORT_MCP_CONFIG_JSON_FORMAT. Default is auto.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-u`, `--db-user`|none|Database user to log in as.|
|`-n`, `--db-name`|none|Database name to log in to.|
|`--[no-]overwrite`|`false`|Overwrites command and environment variable from the config file.|
|`--client-config`|none|If specified, update the specified client config. "claude" for default Claude Desktop config, or specify a JSON file path. Can also be set with environment variable TELEPORT_MCP_CLIENT_CONFIG.|
|`--json-format`|`auto`|Format the JSON file (pretty, compact, auto, none). auto saves in compact if the file is already compact, otherwise pretty. Can also be set with environment variable TELEPORT_MCP_CONFIG_JSON_FORMAT. Default is auto.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|name|none (optional)|Database service name.|

## tsh mcp ls

List available MCP server applications.

Usage:

```code
$ tsh mcp ls [<flags>] [<labels>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-v`, `--[no-]verbose`|`false`|Show extra MCP server fields.|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|

Arguments:

|Argument|Default|Description|
|---|---|---|
|labels|none (optional)|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|

## tsh mfa add

Add a new MFA device.

Usage:

```code
$ tsh mfa add [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--name`|none|Name of the new MFA device.|
|`--type`|none|Type of the new MFA device (TOTP, WEBAUTHN).|

## tsh mfa ls

Get a list of registered MFA devices.

Usage:

```code
$ tsh mfa ls [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-v`, `--[no-]verbose`|`false`|Print more information about MFA devices.|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|

## tsh mfa rm

Remove a MFA device.

Usage:

```code
$ tsh mfa rm <name>
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|name|none (required)|Name or ID of the MFA device to remove.|

## tsh piv agent

Start PIV key agent.

Usage:

```code
$ tsh piv agent
```

## tsh play

Replay the recorded session (SSH, Kubernetes, App, DB).

Usage:

```code
$ tsh play [<flags>] <session-id>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--speed`|`1x`|Playback speed, applicable when streaming SSH or Kubernetes sessions.|
|`--[no-]skip-idle-time`|`false`|Quickly skip over idle time, applicable when streaming SSH or Kubernetes sessions.|
|`-f`, `--format`|`pty`|Format output (pty, json, yaml, text).|

Arguments:

|Argument|Default|Description|
|---|---|---|
|session-id|none (required)|ID or path to session file to play.|

## tsh proxy app

Start local TLS proxy for app connection when using Teleport in single-port
mode.

Usage:

```code
$ tsh proxy app [<flags>] <app>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-p`, `--port`|none|Specifies the listening port used by by the proxy app listener. Accepts an optional target port of a multi-port TCP app after a colon, e.g. "1234:5678".|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|app|none (required)|The name of the application to start local proxy for.|

## tsh proxy aws

Start local proxy for AWS access.

Usage:

```code
$ tsh proxy aws [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional Name of the AWS application to use if logged into multiple.|
|`-p`, `--port`|none|Specifies the source port used by the proxy listener.|
|`-f`, `--format`|`unix`|Optional format to print the commands for setting environment variables, one of: unix, command-prompt, powershell, text. Default is unix. Or specify a service format, one of: athena-odbc, athena-jdbc.|

## tsh proxy azure

Start local proxy for Azure access.

Usage:

```code
$ tsh proxy azure [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional Name of the Azure application to use if logged into multiple.|
|`-p`, `--port`|none|Specifies the source port used by the proxy listener.|
|`-f`, `--format`|`unix`|Optional format to print the commands for setting environment variables, one of: unix, command-prompt, powershell, text. Default is unix.|

## tsh proxy db

Start local TLS proxy for database connections when using Teleport in
single-port mode.

Usage:

```code
$ tsh proxy db [<flags>] [<db>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-p`, `--port`|none|Specifies the source port used by proxy db listener.|
|`--[no-]tunnel`|`false`|Open authenticated tunnel using database's client certificate so clients don't need to authenticate.|
|`-u`, `--db-user`|none|Database user to log in as.|
|`-n`, `--db-name`|none|Database name to log in to.|
|`-r`, `--db-roles`|none|List of comma separate database roles to use for auto-provisioned user.|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--request-reason`|none|Reason for requesting access.|
|`--[no-]disable-access-request`|`false`|Disable automatic resource access requests.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|db|none (optional)|The name of the database to start local proxy for.|

## tsh proxy gcloud

Start local proxy for GCP access.

Usage:

```code
$ tsh proxy gcloud [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--app`|none|Optional Name of the GCP application to use if logged into multiple.|
|`-p`, `--port`|none|Specifies the source port used by the proxy listener.|
|`-f`, `--format`|`unix`|Optional format to print the commands for setting environment variables, one of: unix, command-prompt, powershell, text. Default is unix.|

## tsh proxy kube

Start local proxy for Kubernetes access.

Usage:

```code
$ tsh proxy kube [<flags>] [<kube-cluster>...]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--as`|none|Configure custom Kubernetes user impersonation.|
|`--as-groups`|none|Configure custom Kubernetes group impersonation.|
|`-n`, `--namespace`|none|Configure the default Kubernetes namespace.|
|`-p`, `--port`|none|Specifies the source port used by the proxy listener.|
|`-f`, `--format`|`unix`|Optional format to print the commands for setting environment variables, one of: unix, command-prompt, powershell, text. Default is unix.|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--set-context-name`|`{{.ClusterName}}-{{.KubeName}}`|Define a custom context name or template.|
|`--[no-]exec`|`false`|Run the proxy in the background and reexec into a new shell with $KUBECONFIG already pointed to our config file.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|kube-cluster|none (optional)|Name of the Kubernetes cluster to proxy. Check 'tsh kube ls' for a list of available clusters. If not specified, all clusters previously logged in through `tsh kube login` will be used.|

## tsh proxy ssh

Start local TLS proxy for ssh connections when using Teleport in single-port
mode.

Usage:

```code
$ tsh proxy ssh [<flags>] <[user@]host>
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_NO_RESUME`|`false`|Disable SSH connection resumption.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`--[no-]no-resume`|`false`|Disable SSH connection resumption.|
|`--[no-]relogin`|`true`|Permit performing an authentication attempt on a failed command.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|[user@]host|none (required)|Remote hostname and the login to use.|

## tsh recordings export

Export recorded desktop sessions to video.

Usage:

```code
$ tsh recordings export [<flags>] <session-id>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--out`|none|Override output file name.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|session-id|none (required)|ID of the session to export.|

## tsh recordings ls

List recorded sessions.

Usage:

```code
$ tsh recordings ls [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).. Defaults to 'text'.|
|`--from-utc`|none|Start of time range in which recordings are listed. Format 2006-01-02. Defaults to 24 hours ago.|
|`--to-utc`|none|End of time range in which recordings are listed. Format 2006-01-02. Defaults to current time.|
|`--limit`|`50`|Maximum number of recordings to show. Default 50.|
|`--last`|none|Duration into the past from which session recordings should be listed. Format "5h30m40s".|

## tsh request create

Create a new access request.

Usage:

```code
$ tsh request create [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--roles`|none|Roles to be requested.|
|`--reason`|none|Reason for requesting.|
|`--reviewers`|none|Suggested reviewers.|
|`--[no-]nowait`|`false`|Finish without waiting for request resolution.|
|`--resource`|none|Resource ID to be requested.|
|`--request-ttl`|none|Expiration time for the access request.|
|`--session-ttl`|none|Expiration time for the elevated certificate.|
|`--max-duration`|none|How long the access should be granted for.|
|`--assume-start-time`|none|Sets time roles can be assumed by requestor (RFC3339 e.g 2023-12-12T23:20:50.52Z).|

## tsh request drop

Drop one more access requests from current identity.

Usage:

```code
$ tsh request drop [<request-id>...]
```

Arguments:

|Argument|Default|Description|
|---|---|---|
|request-id|`*` (optional)|IDs of requests to drop (default drops all requests).|

## tsh request ls

List access requests.

Usage:

```code
$ tsh request ls [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--[no-]reviewable`|`false`|Only show requests reviewable by current user.|
|`--[no-]suggested`|`false`|Only show requests that suggest current user as reviewer.|
|`--[no-]my-requests`|`false`|Only show requests created by current user.|

## tsh request review

Review an access request.

Usage:

```code
$ tsh request review [<flags>] <request-id>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--[no-]approve`|`false`|Review proposes approval.|
|`--[no-]deny`|`false`|Review proposes denial.|
|`--reason`|none|Review reason message.|
|`--assume-start-time`|none|Sets time roles can be assumed by requestor (RFC3339 e.g 2023-12-12T23:20:50.52Z).|

Arguments:

|Argument|Default|Description|
|---|---|---|
|request-id|none (required)|ID of target request.|

## tsh request search

Search for resources to request access to.

Usage:

```code
$ tsh request search --kind=KIND [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--kind`|none|Resource kind to search for (node, kube_cluster, db, app, windows_desktop, user_group, pod, secret, configmap, namespace, service, serviceaccount, kube_node, persistentvolume, persistentvolumeclaim, deployment, replicaset, statefulset, daemonset, clusterrole, kube_role, clusterrolebinding, rolebinding, cronjob, job, certificatesigningrequest, ingress, saml_idp_service_provider, aws_ic_account, aws_ic_account_assignment, git_server).|
|`--search`|none|List of comma separated search keywords or phrases enclosed in quotations (e.g. --search=foo,bar,"some phrase").|
|`--query`|none|Query by predicate language enclosed in single quotes. Supports ==, !=, &&, and \|\| (e.g. --query='labels["key1"] == "value1" && labels["key2"] != "value2"').|
|`--labels`|none|List of comma separated labels to filter by labels (e.g. key1=value1,key2=value2).|
|`--kube-cluster`|none|Kubernetes Cluster to search for Pods.|
|`--namespace`|`default`|Kubernetes Namespace to search for Pods.|
|`--[no-]all-kube-namespaces`|`false`|Search Pods in every namespace.|
|`-v`, `--[no-]verbose`|`false`|Verbose table output, shows full label output.|

## tsh request show

Show request details.

Usage:

```code
$ tsh request show [<flags>] <request-id>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|

Arguments:

|Argument|Default|Description|
|---|---|---|
|request-id|none (required)|ID of the target request.|

## tsh resolve

Resolves an SSH host.

Usage:

```code
$ tsh resolve [<flags>] <host>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-q`, `--[no-]quiet`|`false`|Quiet mode.|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|

Arguments:

|Argument|Default|Description|
|---|---|---|
|host|none (required)|Remote hostname to resolve.|

## tsh scan keys

Scan the local machine for SSH private keys and report findings to Teleport.

Usage:

```code
$ tsh scan keys [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--dirs`|`/Users/`|Directories to scan.|
|`--skip-paths`|none|Paths to directories or files to skip. Supports for matching patterns.|

## tsh scp

Transfer files to a remote SSH node.

Usage:

```code
$ tsh scp [<flags>] <from, to>...
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_NO_RESUME`|`false`|Disable SSH connection resumption.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`-r`, `--[no-]recursive`|`false`|Recursive copy of subdirectories.|
|`-P`, `--port`|none|Port to connect to on the remote host.|
|`-p`, `--[no-]preserve`|`false`|Preserves access and modification times from the original file.|
|`-q`, `--[no-]quiet`|`false`|Quiet mode.|
|`--[no-]no-resume`|`false`|Disable SSH connection resumption.|
|`--[no-]relogin`|`true`|Permit performing an authentication attempt on a failed command.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|from, to|none (required)|Source and destination to copy, one must be a local path and one must be a remote path.|

## tsh sessions ls

List active sessions.

Usage:

```code
$ tsh sessions ls [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--kind`|`ssh`,`k8s`,`db`,`app`,`desktop`|Filter by session kind(s).|

## tsh ssh

Run shell or execute a command on a remote SSH node.

Usage:

```code
$ tsh ssh [<flags>] [<[user@]host>] [<command>...]
```

Environment variables:

|Variable|Default|Description|
|---|---|---|
|`TELEPORT_REQUEST_MODE`|`resource`|Type of automatic access request to make (off, resource, role).|
|`TELEPORT_NO_RESUME`|`false`|Disable SSH connection resumption.|

Flags:

|Flag|Default|Description|
|---|---|---|
|`-p`, `--port`|none|SSH port on a remote host.|
|`-A`, `--[no-]forward-agent`|`false`|Forward agent to target node.|
|`-L`, `--forward`|none|Forward localhost connections to remote server.|
|`-D`, `--dynamic-forward`|none|Forward localhost connections to remote server using SOCKS5.|
|`-R`, `--remote-forward`|none|Forward remote connections to localhost.|
|`--[no-]local`|`false`|Execute command on localhost after connecting to SSH node.|
|`-t`, `--[no-]tty`|`false`|Allocate TTY.|
|`-c`, `--cluster`|none|Specify the Teleport cluster to connect.|
|`-o`, `--option`|none|OpenSSH options in the format used in the configuration file.|
|`-N`, `--[no-]no-remote-exec`|`false`|Don't execute remote command, useful for port forwarding.|
|`-X`, `--[no-]x11-untrusted`|`false`|Requests untrusted (secure) X11 forwarding for this session.|
|`-Y`, `--[no-]x11-trusted`|`false`|Requests trusted (insecure) X11 forwarding for this session. This can make your local machine vulnerable to attacks, use with caution.|
|`--x11-untrusted-timeout`|`10m`|Sets a timeout for untrusted X11 forwarding, after which the client will reject any forwarding requests from the server.|
|`--invite`|none|A comma separated list of people to mark as invited for the session.|
|`--reason`|none|The purpose of the session.|
|`--[no-]participant-req`|`false`|Displays a verbose list of required participants in a moderated session.|
|`--request-reason`|none|Reason for requesting access.|
|`--request-mode`|`resource`|Type of automatic access request to make (off, resource, role).|
|`--[no-]disable-access-request`|`false`|Disable automatic resource access requests (DEPRECATED: use --request-mode=off).|
|`--log-dir`|none|Directory to log separated command output, when executing on multiple nodes. If set, output from each node will also be labeled in the terminal.|
|`--[no-]no-resume`|`false`|Disable SSH connection resumption.|
|`--[no-]relogin`|`true`|Permit performing an authentication attempt on a failed command.|
|`-f`, `--[no-]fork-after-authentication`|`false`|Run in background after authentication is complete.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|[user@]host|none (optional)|Remote hostname and the login to use, this argument is required.|
|command|none (optional)|Command to execute on a remote host.|

## tsh status

Display the list of proxy servers and retrieved certificates.

Usage:

```code
$ tsh status [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`-v`, `--[no-]verbose`|`false`|Show extra status information after successful login.|

## tsh svid issue

Issue a SPIFFE SVID using Teleport Workload Identity and write it to a local
directory.

Usage:

```code
$ tsh svid issue --output=OUTPUT [<flags>] <path>
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--type`|`x509`|Type of the SVID to issue (x509). Defaults to x509.|
|`--output`|none|Path to the directory to write the SVID into.|
|`--dns-san`|none|DNS SANs to include in the SVID. By default, none are included.|
|`--ip-san`|none|IP SANs to include in the SVID. By default, none are included.|
|`--svid-ttl`|`1h`|Sets the time to live for the SVID.|

Arguments:

|Argument|Default|Description|
|---|---|---|
|path|none (required)|Path to use for the SVID SPIFFE ID. Must have a preceding '/'.|

## tsh version

Print the tsh client and Proxy server versions for the current context.

Usage:

```code
$ tsh version [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`-f`, `--format`|`text`|Format output (text, json, yaml).|
|`--[no-]client`|`false`|Show the client version only (no server required).|

## tsh vnet

Start Teleport VNet, a virtual network for TCP application access.

Usage:

```code
$ tsh vnet
```

## tsh vnet-ssh-autoconfig

Automatically include VNet's generated OpenSSH-compatible config file in
~/.ssh/config.

Usage:

```code
$ tsh vnet-ssh-autoconfig
```

## tsh workload-identity issue-x509

Use Teleport Workload Identity to issue an X509 credential write it to a local
directory.

Usage:

```code
$ tsh workload-identity issue-x509 --output=OUTPUT [<flags>]
```

Flags:

|Flag|Default|Description|
|---|---|---|
|`--name-selector`|none|The name of the workload identity to issue.|
|`--label-selector`|none|A label-based selector for which workload identities to issue. Multiple labels can be provided using ','.|
|`--credential-ttl`|`1h`|Sets the time to live for the credential.|
|`--output`|none|Path to the directory to write the SVID into.|

