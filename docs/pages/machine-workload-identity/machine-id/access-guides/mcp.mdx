---
title: Machine & Workload Identity with MCP Access
description: How to use Machine & Workload Identity to access MCP servers
labels:
 - how-to
 - mwi
---

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- If you have not already connected your MCP server to Teleport, follow
the [MCP Getting Started guide](../../../enroll-resources/mcp-access/getting-started.mdx).
- (!docs/pages/includes/tctl.mdx!)
- `tbot` and `tsh` must already be installed and configured on the machine that
will access MCP servers. For more information, see the
[deployment guides](../deployment/deployment.mdx).

## Step 1/3. Configure RBAC

First, Teleport must be configured to allow the credentials produced by the bot
to access MCP servers in your infrastructure. In this example, access will be
granted to all MCP servers and all tools within those servers. This is done by
creating a role that grants the necessary permissions and then assigning this
role to the Bot.

```yaml
kind: role
version: v6
metadata:
  name: example-role
spec:
  allow:
    app_labels:
      '*': '*'
    mcp:
      tools: ['*']
```

Replace `example-role` with a descriptive name related to your use case.

In a production environment, you should adjust `app_labels` and `tools` to
restrict this access to only the MCP servers and tools that the bot will need
to access.

Use `tctl create -f ./role.yaml` to create the role.

(!docs/pages/includes/create-role-using-web.mdx!)

Now, use `tctl bots update` to add the role to the Bot. Replace `example`
with the name of the Bot you created in the deployment guide and `example-role`
with the name of the role you just created:

```code
$ tctl bots update example --add-roles example-role
```

## Step 2/3. Configure `tbot`

## Step 3/3. Connect your Agent

## Next steps

- Read the [MCP access documentation](../../../enroll-resources/mcp-access/mcp-access.mdx)
to learn more about Teleport's MCP integration.
- Read the [configuration reference](../../../reference/machine-id/configuration.mdx) to explore
all the available configuration options.
