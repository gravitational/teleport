---
title: Federated Kubernetes Access with Trusted Clusters
description: Federated Access using Teleport trusted clusters.
---

There are cases when you have Kubernetes clusters that have to operate independently,
for example, they are part of a different organization or have intermittent connectivity.

You can take advantage of [trusted clusters](../../management/admin/trustedclusters.mdx)
to federate trust across Kubernetes clusters.

<Tabs>
<TabItem scope={["oss", "enterprise"]} label="Self-Hosted">

When multiple trusted clusters are present behind the Teleport Proxy Service, the
`kubeconfig` generated by [tsh login](../../reference/cli/tsh.mdx#tsh-login) contains the
Kubernetes API endpoint determined by the `<cluster>` argument to [tsh
login](../../reference/cli/tsh.mdx#tsh-login).

For example, consider the following scenario:

- There are three Teleport/Kubernetes clusters: the root cluster named `main` and the leaf clusters 
  named `east` and `west` in the `cluster_name` setting for each cluster.
- The clusters `east` and `west` trust the `main` root cluster certificate authority.
- Users always authenticate against `main` but use their certificates to access
  SSH nodes and the Kubernetes API in all three clusters.
- The DNS name of the root cluster Teleport Proxy Service is `main.example.com`.

In this scenario, users usually log in using the following command:

```code
# Using login without arguments
$ tsh --proxy=main.example.com login

# User's `kubeconfig` now contains one entry for the main Kubernetes
# endpoint, i.e. `main.example.com`.

# Receive a certificate for "east":
$ tsh --proxy=main.example.com login east

# User's `kubeconfig` now contains the entry for the "east" Kubernetes
# endpoint, i.e. `east.main.example.com`.
```

</TabItem>
<TabItem scope={["cloud","team"]} label="Cloud-Hosted">

When multiple trusted clusters are present behind the Teleport Proxy Service, the
`kubeconfig` generated by [tsh login](../../reference/cli/tsh.mdx#tsh-login) contains the
Kubernetes API endpoint determined by the `<cluster>` argument to the [tsh
login](../../reference/cli/tsh.mdx#tsh-login) command.

For example, consider the following scenario:

- There are two Teleport/Kubernetes clusters named `east` and `west`.
  Each cluster has its own configuration file with its name specified in the 
  `cluster_name` field.
- The clusters `east` and `west` are leaf clusters that trust a Teleport Team 
  or Enterprise Cloud account, for example, `mytenant.teleport.sh`.
- Users always authenticate against `mytenant.teleport.sh` but use their certificates to access
  SSH nodes and the Kubernetes API in all three clusters.

In this scenario, users usually log in using the following command:

```code
# Using login without arguments
$ tsh --proxy=mytenant.teleport.sh login

# User's `kubeconfig` now contains one entry for the main Kubernetes
# endpoint, i.e. `mytenant.teleport.sh`.

# Receive a certificate for "east":
$ tsh --proxy=mytenant.teleport.sh login east

# User's `kubeconfig` now contains the entry for the "east" Kubernetes
# endpoint, i.e. `east.mytenant.teleport.sh`.
```

</TabItem>
</Tabs>
