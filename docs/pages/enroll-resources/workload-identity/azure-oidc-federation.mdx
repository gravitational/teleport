---
title: Configuring Workload Identity and Azure Federated Credentials
description: Configuring Azure to accept Workload Identity JWTs as authentication using Azure Federated Credentials
---

(!/docs/pages/includes/workload-id-preview.mdx!)

Teleport Workload Identity issues flexible short-lived identities in JWT format.
Azure Federated Credentials allows you to use these JWTs to authenticate to
Azure services.

This can be useful in cases where a machine needs to securely authenticate with
Azure services without the use of a long-lived credential. This is because the
machine can authenticate with Teleport without using any shared secrets by
using one of our delegated join methods.

In this guide, we'll configure Teleport Workload Identity and Azure to allow our
workload to authenticate to the Azure Blob Storage and upload content to a
container.

## How it works

This implementation differs from using the Teleport Application Service to
protect Azure APIs in a few ways:

- Requests to Azure are not proxied through the Teleport Proxy Service, meaning
  reduced latency but also less visibility, as these requests will not be
  recorded in Teleport's audit log.
- Workload Identity works with any Azure client, including the command-line tool
  but also their SDKs.
- Using the Teleport Application Service to access Azure does not work with
  Machine ID and therefore cannot be used when a machine needs to authenticate
  with Azure.

1. Create User Managed Identity
2. Create Federated credential
3. Assign role to Federated Credential.

## Prerequisites

(!docs/pages/includes/edition-prereqs-tabs.mdx!)

- (!docs/pages/includes/tctl.mdx!)
- `tbot` must already be installed and configured on the host where the
  workloads which need to access Teleport Workload Identity will run. For more
  information, see the [deployment
  guides](../machine-id/deployment/deployment.mdx).

<Notice type="warning">
Issuing JWT SVIDs with Teleport Workload Identity requires at least Teleport
version 16.4.3.
</Notice>

### Deciding on a SPIFFE ID structure

Within Teleport Workload Identity, all identities are represented using a
SPIFFE ID. This is a URI that uniquely identifies the entity that the identity
represents. The scheme is always `spiffe://`, and the host will be the name of
your Teleport cluster. The structure of the path of this URI is up to you.

For the purposes of this guide, we will be granting access to Azure to the
`spiffe://example.teleport.sh/svc/example-service` SPIFFE ID.

If you have already deployed Teleport Workload Identity, then you will already
have a SPIFFE ID structure in place. If you have not, then you will need to
decide on a structure for your SPIFFE IDs.

If you are only using Teleport Workload Identity with AWS OIDC Federation, you
may structure your SPIFFE IDs so that they explicitly specify the Azure
user-managed identity they are allowed to assume. However, it often makes more
sense to name the workload or person that will use the SPIFFE ID. See the
[best practices guide](./best-practices.mdx) for further advice.

## Next steps

- [Azure Workload Identity Federation](https://learn.microsoft.com/en-us/entra/workload-id/workload-identity-federation):
The official Azure documentation for Workload Identity Federation.
- [Workload Identity Overview](./introduction.mdx): Overview of Teleport
Workload Identity.
- [JWT SVID Overview](./jwt-svids.mdx): Overview of the JWT SVIDs issued by
Teleport Workload Identity.
- [Best Practices](./best-practices.mdx): Best practices for using Workload
Identity in Production.
- Read the [configuration reference](../../reference/machine-id/configuration.mdx) to explore
all the available configuration options.
