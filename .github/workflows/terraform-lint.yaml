name: Lint (Terraform)

on:
  pull_request:
    paths:
      - '**.tf'
      - '**.tf.json'
      - '**.hcl'
  merge_group:
    paths:
      - '**.tf'
      - '**.tf.json'
      - '**.hcl'
  workflow_dispatch:

jobs:
  terraform-lint:
    uses: gravitational/shared-workflows/.github/workflows/terraform-lint.yaml@8804e927040482769e2972b560435e3e8de61d75 # TODO(gavin): update this before merging to point at workflows/v0.0.3 once it's released
    with:
      # TODO: Fix Terraform linting issues and stop using force to pass the job.
      tflint_force: true
      tflint_config_path: $GITHUB_WORKSPACE/.tflint.hcl
      terraform_docs_config_path: $GITHUB_WORKSPACE/integrations/terraform-modules/.terraform-docs.yml
      terraform_docs_find_dir: $GITHUB_WORKSPACE/integrations/terraform-modules
    permissions:
      actions: read
      contents: read
      pull-requests: write
