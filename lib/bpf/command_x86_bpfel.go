// Code generated by bpf2go; DO NOT EDIT.
//go:build (386 || amd64) && bpf

package bpf

import (
	"bytes"
	_ "embed"
	"fmt"
	"io"
	"structs"

	"github.com/cilium/ebpf"
)

type commandDataT struct {
	_              structs.HostLayout
	Pid            uint64
	Ppid           uint64
	Command        [16]uint8
	Type           uint32
	Argv           [1024]uint8
	Retval         int32
	Cgroup         uint64
	AuditSessionId uint32
	_              [4]byte
}

// loadCommand returns the embedded CollectionSpec for command.
func loadCommand() (*ebpf.CollectionSpec, error) {
	reader := bytes.NewReader(_CommandBytes)
	spec, err := ebpf.LoadCollectionSpecFromReader(reader)
	if err != nil {
		return nil, fmt.Errorf("can't load command: %w", err)
	}

	return spec, err
}

// loadCommandObjects loads command and converts it into a struct.
//
// The following types are suitable as obj argument:
//
//	*commandObjects
//	*commandPrograms
//	*commandMaps
//
// See ebpf.CollectionSpec.LoadAndAssign documentation for details.
func loadCommandObjects(obj interface{}, opts *ebpf.CollectionOptions) error {
	spec, err := loadCommand()
	if err != nil {
		return err
	}

	return spec.LoadAndAssign(obj, opts)
}

// commandSpecs contains maps and programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type commandSpecs struct {
	commandProgramSpecs
	commandMapSpecs
	commandVariableSpecs
}

// commandProgramSpecs contains programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type commandProgramSpecs struct {
	TracepointSyscallsSysEnterExecve   *ebpf.ProgramSpec `ebpf:"tracepoint__syscalls__sys_enter_execve"`
	TracepointSyscallsSysEnterExecveat *ebpf.ProgramSpec `ebpf:"tracepoint__syscalls__sys_enter_execveat"`
	TracepointSyscallsSysExitExecve    *ebpf.ProgramSpec `ebpf:"tracepoint__syscalls__sys_exit_execve"`
	TracepointSyscallsSysExitExecveat  *ebpf.ProgramSpec `ebpf:"tracepoint__syscalls__sys_exit_execveat"`
}

// commandMapSpecs contains maps before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type commandMapSpecs struct {
	ExecveEvents        *ebpf.MapSpec `ebpf:"execve_events"`
	LostCounter         *ebpf.MapSpec `ebpf:"lost_counter"`
	LostDoorbell        *ebpf.MapSpec `ebpf:"lost_doorbell"`
	MonitoredSessionids *ebpf.MapSpec `ebpf:"monitored_sessionids"`
}

// commandVariableSpecs contains global variables before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type commandVariableSpecs struct {
	Unused *ebpf.VariableSpec `ebpf:"unused"`
}

// commandObjects contains all objects after they have been loaded into the kernel.
//
// It can be passed to loadCommandObjects or ebpf.CollectionSpec.LoadAndAssign.
type commandObjects struct {
	commandPrograms
	commandMaps
	commandVariables
}

func (o *commandObjects) Close() error {
	return _CommandClose(
		&o.commandPrograms,
		&o.commandMaps,
	)
}

// commandMaps contains all maps after they have been loaded into the kernel.
//
// It can be passed to loadCommandObjects or ebpf.CollectionSpec.LoadAndAssign.
type commandMaps struct {
	ExecveEvents        *ebpf.Map `ebpf:"execve_events"`
	LostCounter         *ebpf.Map `ebpf:"lost_counter"`
	LostDoorbell        *ebpf.Map `ebpf:"lost_doorbell"`
	MonitoredSessionids *ebpf.Map `ebpf:"monitored_sessionids"`
}

func (m *commandMaps) Close() error {
	return _CommandClose(
		m.ExecveEvents,
		m.LostCounter,
		m.LostDoorbell,
		m.MonitoredSessionids,
	)
}

// commandVariables contains all global variables after they have been loaded into the kernel.
//
// It can be passed to loadCommandObjects or ebpf.CollectionSpec.LoadAndAssign.
type commandVariables struct {
	Unused *ebpf.Variable `ebpf:"unused"`
}

// commandPrograms contains all programs after they have been loaded into the kernel.
//
// It can be passed to loadCommandObjects or ebpf.CollectionSpec.LoadAndAssign.
type commandPrograms struct {
	TracepointSyscallsSysEnterExecve   *ebpf.Program `ebpf:"tracepoint__syscalls__sys_enter_execve"`
	TracepointSyscallsSysEnterExecveat *ebpf.Program `ebpf:"tracepoint__syscalls__sys_enter_execveat"`
	TracepointSyscallsSysExitExecve    *ebpf.Program `ebpf:"tracepoint__syscalls__sys_exit_execve"`
	TracepointSyscallsSysExitExecveat  *ebpf.Program `ebpf:"tracepoint__syscalls__sys_exit_execveat"`
}

func (p *commandPrograms) Close() error {
	return _CommandClose(
		p.TracepointSyscallsSysEnterExecve,
		p.TracepointSyscallsSysEnterExecveat,
		p.TracepointSyscallsSysExitExecve,
		p.TracepointSyscallsSysExitExecveat,
	)
}

func _CommandClose(closers ...io.Closer) error {
	for _, closer := range closers {
		if err := closer.Close(); err != nil {
			return err
		}
	}
	return nil
}

// Do not access this directly.
//
//go:embed command_x86_bpfel.o
var _CommandBytes []byte
